# üîê –ó–ê–ù–Ø–¢–ò–ï 2 ‚Äî –ö–õ–Æ–ß–ò, –¢–û–ö–ï–ù–´ –ò –£–ü–†–ê–í–õ–ï–ù–ò–ï –°–ï–ö–†–ï–¢–ê–ú–ò

## 1. –¶–µ–ª—å

–ü–æ–Ω—è—Ç—å, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ:

* —Ö—Ä–∞–Ω–∏—Ç—å –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∫–ª—é—á–∏;
* —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω—ã (session, bearer, JWT);
* –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ–¥–ø–∏—Å–∏ –∏ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è —Ç–æ–∫–µ–Ω–æ–≤;
* –∑–∞—â–∏—â–∞—Ç—å –∫–ª—é—á–∏ –æ—Ç —É—Ç–µ—á–∫–∏.

---

## 2. –¢–∏–ø–∏—á–Ω—ã–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏

1. –ö–ª—é—á–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –∫–æ–¥–µ –∏–ª–∏ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.
2. –¢–æ–∫–µ–Ω—ã –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω—ã (base64 –±–µ–∑ HMAC).
3. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è —Ç–æ–∫–µ–Ω–∞.
4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, user_id + timestamp).
5. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ¬´None¬ª –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –≤ JWT.
6. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä–æ—Ç–∞—Ü–∏–∏ —Å–µ–∫—Ä–µ—Ç–æ–≤.

---

## 3. –ö–ª—é—á–µ–≤—ã–µ –ø–æ–Ω—è—Ç–∏—è

* **–°–µ–∫—Ä–µ—Ç (Secret key)** ‚Äî —Å—Ç—Ä–æ–∫–∞, –∏–∑–≤–µ—Å—Ç–Ω–∞—è —Ç–æ–ª—å–∫–æ —Å–µ—Ä–≤–µ—Ä—É, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–¥–ø–∏—Å–∏.
* **–ü–æ–¥–ø–∏—Å—å (HMAC)** ‚Äî —Å–ø–æ—Å–æ–± —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ–¥–¥–µ–ª–∞–Ω—ã.
* **–¢–æ–∫–µ–Ω** ‚Äî —Å—Ä–µ–¥—Å—Ç–≤–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–µ–∑ –ø–∞—Ä–æ–ª—è.
* **JWT (JSON Web Token)** ‚Äî —Ç–æ–∫–µ–Ω –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON, –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π HMAC –∏–ª–∏ RSA.

---

## 4. HMAC (Hash-based Message Authentication Code)

–§–æ—Ä–º—É–ª–∞:

```
HMAC = hash(secret + message)
```

**–ó–∞—á–µ–º –Ω—É–∂–µ–Ω:**
–ü–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –Ω–µ –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω—ã.
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ API –∏ JWT.

**–ü—Ä–∏–º–µ—Ä:**

```python
import hmac, hashlib

msg = b"username=admin"
secret = b"topsecret"
signature = hmac.new(secret, msg, hashlib.sha256).hexdigest()
```

---

## 5. Base64 ‚â† –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

–ú–Ω–æ–≥–∏–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥—É–º–∞—é—Ç, —á—Ç–æ —Ç–æ–∫–µ–Ω –≤—Ä–æ–¥–µ

```python
token = base64.b64encode(f"{username}:{timestamp}".encode())
```

–±–µ–∑–æ–ø–∞—Å–µ–Ω.
–ù–æ base64 ‚Äî **–ø—Ä–æ—Å—Ç–æ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ**, –Ω–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ.
–ï–≥–æ –º–æ–∂–Ω–æ —Ä–∞—Å–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –∏ –∏–∑–º–µ–Ω–∏—Ç—å.

---

## 6. JWT (JSON Web Token)

JWT —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 3 —á–∞—Å—Ç–µ–π:

```
header.payload.signature
```

### –ü—Ä–∏–º–µ—Ä:

```
eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1c2VyMSIsImlhdCI6MTcxNjA3NDI2OSwiZXhwIjoxNzE2MDc0ODI5fQ.NL56M0U0...
```

### –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ:

```python
import jwt
SECRET = "mysecret"
payload = jwt.decode(token, SECRET, algorithms=["HS256"])
```

---

## 7. –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ JWT

* –°–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω: –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–µ—Å—Å–∏–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.
* –ú–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è (`exp`).
* –ú–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ–¥–ø–∏—Å—å –±–µ–∑ –ë–î.

---

## 8. –û–ø–∞—Å–Ω–æ—Å—Ç–∏ JWT

1. –ê–ª–≥–æ—Ä–∏—Ç–º `"none"` ‚Üí —Ç–æ–∫–µ–Ω –º–æ–∂–Ω–æ –ø–æ–¥–¥–µ–ª–∞—Ç—å.
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞—Å–∏–º–º–µ—Ç—Ä–∏–∏ –∫–∞–∫ —Å–∏–º–º–µ—Ç—Ä–∏–∏ (–ø–æ–¥–º–µ–Ω–∞ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞).
3. –ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Å—Ä–æ–∫ –∂–∏–∑–Ω–∏ (`exp` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç).
4. –£—Ç–µ—á–∫–∞ `SECRET_KEY`.

---

## 9. –ö–∞–∫ —Ö—Ä–∞–Ω–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã

| –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ                      | –ü—Ä–∞–≤–∏–ª—å–Ω–æ                         |
| -------------------------------- | --------------------------------- |
| –í –∫–æ–¥–µ (`SECRET_KEY = "12345"`)  | –í .env —Ñ–∞–π–ª–µ                      |
| –í Git                            | –í secrets manager (Vault, AWS SM) |
| –í cookie –±–µ–∑ —Ñ–ª–∞–≥–æ–≤              | –° —Ñ–ª–∞–≥–∞–º–∏ Secure, HttpOnly        |
| –î–æ–ª–≥–æ–∂–∏–≤—É—â–∏–π —Ç–æ–∫–µ–Ω –±–µ–∑ —Ä–µ–≤–æ–∫–∞—Ü–∏–∏ | Refresh —Ç–æ–∫–µ–Ω —Å —Ä–æ—Ç–∞—Ü–∏–µ–π          |

–ü—Ä–∏–º–µ—Ä `.env`:

```
SECRET_KEY=change-me
JWT_EXPIRATION=600
```

---

## 10. Refresh —Ç–æ–∫–µ–Ω

* Access-—Ç–æ–∫–µ–Ω: –∂–∏–≤—ë—Ç 5‚Äì15 –º–∏–Ω—É—Ç.
* Refresh-—Ç–æ–∫–µ–Ω: –∂–∏–≤—ë—Ç –¥–æ–ª—å—à–µ, —Ö—Ä–∞–Ω–∏—Ç—Å—è –±–µ–∑–æ–ø–∞—Å–Ω–æ.
* –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ access-—Ç–æ–∫–µ–Ω–∞ ‚Äî refresh –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–æ–≤—ã–º (rotate-on-use).

---

## 11. –†–æ—Ç–∞—Ü–∏—è –∫–ª—é—á–µ–π

* –°—Ç–∞—Ä—ã–π –∫–ª—é—á ‚Üí `kid=1`, –Ω–æ–≤—ã–π ‚Üí `kid=2`.
* –°–µ—Ä–≤–µ—Ä —Ö—Ä–∞–Ω–∏—Ç –æ–±–∞ –∏ –º–æ–∂–µ—Ç –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–µ —Ç–æ–∫–µ–Ω—ã.
* –ü—Ä–∏ –¥–µ–ø–ª–æ–µ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –∫–ª—é—á–∏ –±–µ–∑ ¬´–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤—ã—Ö–æ–¥–∞¬ª –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

---

## 12. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏ —Ç–æ–∫–µ–Ω–æ–≤

```python
def verify_token(token):
    try:
        payload = jwt.decode(token, SECRET_KEY, algorithms=["HS256"])
        return payload
    except jwt.ExpiredSignatureError:
        raise Unauthorized("Token expired")
    except jwt.InvalidTokenError:
        raise Unauthorized("Invalid token")
```

---

## 13. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è

* –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HTTPS.
* –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Ç–æ–∫–µ–Ω –≤ URL.
* –î–ª—è –±—Ä–∞—É–∑–µ—Ä–æ–≤ ‚Äî –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–∫–µ–Ω –≤ cookie —Å HttpOnly + Secure.

---

## 14. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ä—ã

‚úÖ –ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ –∫–æ–¥–µ.<br/>
‚úÖ –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Base64 –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–∞—â–∏—Ç—ã.<br/>
‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å—Ä–æ–∫ –∂–∏–∑–Ω–∏ —Ç–æ–∫–µ–Ω–∞ (`exp`).<br/>
‚úÖ –†–µ–∞–ª–∏–∑—É–π—Ç–µ refresh flow –∏ revocation list.<br/>
‚úÖ –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –∫–ª—é—á–∏.<br/>
‚úÖ –õ–æ–≥–∏—Ä—É–π—Ç–µ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ç–æ–∫–µ–Ω–æ–≤, –∞ —Ç–æ–ª—å–∫–æ `sub` –∏–ª–∏ `kid`.<br/>

---

## 15. –î–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è

* –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç, –µ—Å–ª–∏ `SECRET_KEY` —É—Ç–µ—á—ë—Ç?
* –ü–æ—á–µ–º—É –Ω–µ–ª—å–∑—è —Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–∫–µ–Ω –≤ localStorage?
* –í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É ‚Äú—à–∏—Ñ—Ä–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω‚Äù –∏ ‚Äú–ø–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å —Ç–æ–∫–µ–Ω‚Äù?

---

## 16. –î–ª—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–≥–æ —á—Ç–µ–Ω–∏—è

* [OWASP JSON Web Token Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/JSON_Web_Token_Cheat_Sheet_for_Java.html)
* [OWASP Cryptographic Storage Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html)
* [RFC 7519: JSON Web Token (JWT)](https://datatracker.ietf.org/doc/html/rfc7519)

---

## 17. –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã

1. –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –ø–æ–¥–ø–∏—Å—å –≤ HMAC?
2. –ü–æ—á–µ–º—É base64-—Ç–æ–∫–µ–Ω –ª–µ–≥–∫–æ –ø–æ–¥–¥–µ–ª–∞—Ç—å?
3. –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ç–æ–∫–µ–Ω –Ω–µ —É—Å—Ç–∞—Ä–µ–ª?
4. –ß—Ç–æ —Ç–∞–∫–æ–µ —Ä–æ—Ç–∞—Ü–∏—è –∫–ª—é—á–µ–π?
5. –ü–æ—á–µ–º—É —Å–µ–∫—Ä–µ—Ç –Ω–µ–ª—å–∑—è —Ö—Ä–∞–Ω–∏—Ç—å –≤ Git?

---
---

# üîë –†–∞–∑–¥–µ–ª 2. API-–∫–ª—é—á–∏ –∏ —Ç–æ–∫–µ–Ω—ã

## 1. –í–≤–µ–¥–µ–Ω–∏–µ

–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —á–∞—Å—Ç–æ –æ–±–º–µ–Ω–∏–≤–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–º–∏ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏ ‚Äî —á–µ—Ä–µ–∑ **API**.
–î–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è **—Å–µ–∫—Ä–µ—Ç—ã**, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º—ã:

* API-–∫–ª—é—á–∏
* –¢–æ–∫–µ–Ω—ã (JWT, opaque tokens, access / refresh tokens)
* –ü–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Å—ã–ª–∫–∏ (signed URLs)
* –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã (—Ä–µ–∂–µ)

–í—Å–µ —ç—Ç–∏ –º–µ—Ö–∞–Ω–∏–∑–º—ã –ø–æ —Å—É—Ç–∏ —Ä–µ—à–∞—é—Ç –æ–¥–Ω—É –∑–∞–¥–∞—á—É:

> *–ø–µ—Ä–µ–¥–∞—Ç—å –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ, —á—Ç–æ –∑–∞–ø—Ä–æ—Å –∏—Å—Ö–æ–¥–∏—Ç –æ—Ç –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–≥–æ —Å—É–±—ä–µ–∫—Ç–∞.*

---

## 2. –ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–µ—Ä–º–∏–Ω–∞—Ö OWASP

–ö–∞—Ç–µ–≥–æ—Ä–∏—è **Cryptographic Failures** –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —Å–ª—É—á–∞–∏, –∫–æ–≥–¥–∞:

* —Å–µ–∫—Ä–µ—Ç—ã —Å–æ–∑–¥–∞—é—Ç—Å—è, —Ö—Ä–∞–Ω—è—Ç—Å—è –∏–ª–∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ;
* –∫–ª—é—á–∏ –∏–º–µ—é—Ç –Ω–∏–∑–∫—É—é —ç–Ω—Ç—Ä–æ–ø–∏—é;
* –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –Ω–µ–ø–æ–¥—Ö–æ–¥—è—â–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –∏–ª–∏ —Ñ–æ—Ä–º–∞—Ç—ã —Ç–æ–∫–µ–Ω–æ–≤;
* —Å–µ–∫—Ä–µ—Ç—ã ¬´—É—Ç–µ–∫–∞—é—Ç¬ª –≤ –∫–æ–¥, —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π, –ª–æ–≥ –∏–ª–∏ –∫–ª–∏–µ–Ω—Ç—Å–∫—É—é —á–∞—Å—Ç—å.

**–ö–ª—é—á–µ–≤—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏:**

* –°–µ–∫—Ä–µ—Ç—ã –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ –≤ GitHub –∏–ª–∏ `.env` –±–µ–∑ –∑–∞—â–∏—Ç—ã;
* –ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–µ —Ç–æ–∫–µ–Ω—ã (`user12345token`);
* –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä–æ—Ç–∞—Ü–∏–∏ –∏ —Å—Ä–æ–∫–æ–≤ –¥–µ–π—Å—Ç–≤–∏—è;
* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ JWT –±–µ–∑ –ø–æ–¥–ø–∏—Å–∏ (`alg: none`) –∏–ª–∏ —Å–æ —Å–ª–∞–±—ã–º HMAC-–∫–ª—é—á–æ–º;
* –î–æ–ª–≥–æ–∂–∏–≤—É—â–∏–µ access-—Ç–æ–∫–µ–Ω—ã –±–µ–∑ refresh-–º–µ—Ö–∞–Ω–∏–∑–º–∞.

---

## 3. API-–∫–ª—é—á–∏: –ø—Ä–∏–Ω—Ü–∏–ø—ã –∏ —Ä–∏—Å–∫–∏

### 3.1 –ß—Ç–æ —Ç–∞–∫–æ–µ API-–∫–ª—é—á

**API-–∫–ª—é—á** ‚Äî —ç—Ç–æ —É–Ω–∏–∫–∞–ª—å–Ω–∞—è —Å—Ç—Ä–æ–∫–∞, –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –∫–ª–∏–µ–Ω—Ç–æ–º –∏–ª–∏ —Å–µ—Ä–≤–∏—Å–æ–º,
–∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–∏ –≤—ã–∑–æ–≤–∞—Ö API.

–ü—Ä–∏–º–µ—Ä:

```http
GET /v1/data
Authorization: ApiKey 4fbd9a7e-2a9f-4c3d-bf89-22e2bbf34f73
```

–û–±—ã—á–Ω–æ –∫–ª—é—á:

* —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞;
* —Ö—Ä–∞–Ω–∏—Ç—Å—è **–≤ –±–∞–∑–µ –≤ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ** (–∫–∞–∫ –ø–∞—Ä–æ–ª—å);
* –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ.

### 3.2 –†–∏—Å–∫–∏

| –û—à–∏–±–∫–∞                                      | –ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏–µ                                    |
| ------------------------------------------- | ---------------------------------------------- |
| –•—Ä–∞–Ω–µ–Ω–∏–µ API-–∫–ª—é—á–∞ –≤ –∫–æ–¥–µ –∏–ª–∏ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ | –º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è                       |
| –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ IP –∏–ª–∏ –¥–æ–º–µ–Ω—É     | –∫—Ä–∞–∂–∞ = –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø                          |
| –ù–µ—Ç —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è                          | –∫–ª—é—á –¥–µ–π—Å—Ç–≤—É–µ—Ç –≤–µ—á–Ω–æ                           |
| –ù–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è               | –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–¥–∏—Ç—å —É—Ç–µ—á–∫—É                    |
| –ù–µ—Ç —Ä–æ—Ç–∞—Ü–∏–∏                                 | –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è ‚Üí —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–æ–µ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ |

### 3.3 –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

* –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–µ 128+ –±–∏—Ç –∫–ª—é—á–µ–π (UUIDv4 –∏–ª–∏ os.urandom/hex).
* –•—Ä–∞–Ω–∏—Ç—å –≤ –ë–î **—Ç–æ–ª—å–∫–æ —Ö—ç—à –∫–ª—é—á–∞** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `bcrypt`).
* –í –æ—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤—ã–¥–∞–≤–∞—Ç—å **—Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑** ‚Äî –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏.
* –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å –ø—Ä–∞–≤–∞ (scopes) –∏ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è.
* –û–±–µ—Å–ø–µ—á–∏—Ç—å –∞—É–¥–∏—Ç –∏ —Ä–æ—Ç–∞—Ü–∏—é (–ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é, –ø—Ä–∏ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏).

---

## 4. –¢–æ–∫–µ–Ω—ã

### 4.1 –í–∏–¥—ã —Ç–æ–∫–µ–Ω–æ–≤

| –í–∏–¥                      | –ü—Ä–∏–º–µ—Ä                                    | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏                                             |
| ------------------------ | ----------------------------------------- | ------------------------------------------------------- |
| **Opaque token**         | `d1e3a2f6...`                             | –ü—Ä–æ—Å—Ç–æ —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç—Ä–æ–∫–∞, —Å–µ—Ä–≤–µ—Ä —Ö—Ä–∞–Ω–∏—Ç —Å–µ—Å—Å–∏—é –≤ –ë–î      |
| **JWT (JSON Web Token)** | `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...` | –°–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π: —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ (claims) –∏ –ø–æ–¥–ø–∏—Å—å       |
| **Signed URL token**     | `?expires=...&signature=...`              | –î–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ—Å—É—Ä—Å–∞–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ñ–∞–π–ª–∞–º) |

### 4.2 JWT ‚Äî —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∏ —Ä–∏—Å–∫–∏

JWT = `header.payload.signature`, –≥–¥–µ:

```json
Header:  {"alg": "HS256", "typ": "JWT"}
Payload: {"sub": "user123", "exp": 1714668400}
Signature: HMAC_SHA256(secret, header + "." + payload)
```

**–¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏:**

* `alg: none` ‚Üí —Ç–æ–∫–µ–Ω –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è –±–µ–∑ –ø–æ–¥–ø–∏—Å–∏;
* —Å–ª–∞–±—ã–π –∏–ª–∏ –ø—É–±–ª–∏—á–Ω—ã–π —Å–µ–∫—Ä–µ—Ç (`secret123`);
* –±–µ–∑ `exp` –∏ `iat` ‚Üí —Ç–æ–∫–µ–Ω –∂–∏–≤—ë—Ç –≤–µ—á–Ω–æ;
* —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –≤ `localStorage` ‚Üí XSS = —É–≥–æ–Ω —Å–µ—Å—Å–∏–∏;
* –¥–æ–≤–µ—Ä–∏–µ –∫ claims –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `alg=HS256` –∏–ª–∏ `RS256` (HMAC –∏–ª–∏ –∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–∞—è –ø–æ–¥–ø–∏—Å—å);
* –ú–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è (`exp`);
* –ü—Ä–æ–≤–µ—Ä—è—Ç—å `iat`, `nbf`, `aud`, `iss`;
* –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `none`;
* –î–ª—è –¥–æ–ª–≥–æ–∂–∏–≤—É—â–∏—Ö —Å–µ—Å—Å–∏–π ‚Äî –ø–∞—Ä–∞ **access/refresh** —Ç–æ–∫–µ–Ω–æ–≤.

---

## 5. –•—Ä–∞–Ω–µ–Ω–∏–µ –∏ –ø–µ—Ä–µ–¥–∞—á–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤

### 5.1 –ì–¥–µ –Ω–µ–ª—å–∑—è —Ö—Ä–∞–Ω–∏—Ç—å

* –í –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–¥–µ (`settings.py`, `.js`, `.env` –±–µ–∑ –∑–∞—â–∏—Ç—ã);
* –í –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π —á–∞—Å—Ç–∏ (HTML, JS);
* –í –ª–æ–≥–∞—Ö, —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –æ—à–∏–±–æ–∫;
* –í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è—Ö.

### 5.2 –ì–¥–µ –º–æ–∂–Ω–æ

* **–ú–µ–Ω–µ–¥–∂–µ—Ä —Å–µ–∫—Ä–µ—Ç–æ–≤** (AWS Secrets Manager, HashiCorp Vault, Doppler, 1Password CLI);
* **.env + OS perms** (—Ñ–∞–π–ª `.env` —Å –ø—Ä–∞–≤–∞–º–∏ `600` –∏ –≤ `.gitignore`);
* **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è** –Ω–∞ –ø—Ä–æ–¥–µ;
* **CI/CD —Å–µ–∫—Ä–µ—Ç—ã** (GitHub Actions Secrets, GitLab CI Variables).

---

## 6. –†–æ—Ç–∞—Ü–∏—è –∫–ª—é—á–µ–π –∏ —Ç–æ–∫–µ–Ω–æ–≤

–†–æ—Ç–∞—Ü–∏—è = –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –∑–∞–º–µ–Ω–∞ –∫–ª—é—á–∞ –±–µ–∑ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–∏—Å–∞.

### –î–ª—è API-–∫–ª—é—á–µ–π

* —Å—Ç–∞—Ä—ã–π –∫–ª—é—á ‚Üí –ø–µ—Ä–µ–≤–æ–¥ –≤ —Å—Ç–∞—Ç—É—Å ¬´deprecated¬ª;
* –≤—ã–¥–∞—á–∞ –Ω–æ–≤–æ–≥–æ ‚Üí –æ–±–∞ –¥–µ–π—Å—Ç–≤—É—é—Ç X —á–∞—Å–æ–≤;
* –ø–æ—Å–ª–µ grace-–ø–µ—Ä–∏–æ–¥–∞ ‚Äî —Å—Ç–∞—Ä—ã–π –æ—Ç–∑—ã–≤–∞–µ—Ç—Å—è.

### –î–ª—è JWT

* access-—Ç–æ–∫–µ–Ω –∫–æ—Ä–æ—Ç–∫–∏–π (15‚Äì30 –º–∏–Ω);
* refresh-—Ç–æ–∫–µ–Ω –¥–ª–∏–Ω–Ω—ã–π (7‚Äì30 –¥–Ω–µ–π);
* –ø—Ä–∏ –∫–∞–∂–¥–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ refresh-—Ç–æ–∫–µ–Ω –ø–µ—Ä–µ—Å–æ–∑–¥–∞—ë—Ç—Å—è (rotation refresh token pattern);
* –ø—Ä–∏ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ ‚Äî –∑–∞–Ω–µ—Å–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –≤ ¬´—á—ë—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫¬ª.

---

## 7. –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –≤ –∫–ª–∏–µ–Ω—Ç–∞—Ö

| –ö–ª–∏–µ–Ω—Ç  | –ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–∫–µ–Ω                         | –ü–æ—á–µ–º—É                    |
| ------- | ----------------------------------------- | ------------------------- |
| Web SPA | `httpOnly secure cookie`                  | –∑–∞—â–∏—Ç–∞ –æ—Ç XSS             |
| Mobile  | –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (Keychain, Keystore) | –∑–∞—â–∏—Ç–∞ –æ—Ç —Ä—É—Ç-–¥–æ—Å—Ç—É–ø–∞     |
| Desktop | OS keyring / encrypted config             | –∑–∞—â–∏—Ç–∞ –æ—Ç —á—Ç–µ–Ω–∏—è –∏–∑ —Ñ–∞–π–ª–∞ |

**–ù–µ–ª—å–∑—è:**

* –∫–ª–∞—Å—Ç—å —Ç–æ–∫–µ–Ω –≤ `localStorage` (XSS),
* –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Ç–æ–∫–µ–Ω –≤ URL (–º–æ–∂–µ—Ç –ø–æ–ø–∞—Å—Ç—å –≤ –ª–æ–≥–∏).

---

## 8. –ü—Ä–∏–º–µ—Ä —Ö–æ—Ä–æ—à–µ–π –ø—Ä–∞–∫—Ç–∏–∫–∏ (Django / FastAPI)

```python
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è API-–∫–ª—é—á–∞
import secrets
def generate_api_key():
    return secrets.token_urlsafe(32)  # ~192 –±–∏—Ç —ç–Ω—Ç—Ä–æ–ø–∏–∏

# –ü—Ä–æ–≤–µ—Ä–∫–∞
from passlib.hash import bcrypt
stored_hash = bcrypt.hash(api_key)
bcrypt.verify(provided_key, stored_hash)

# –°–æ–∑–¥–∞–Ω–∏–µ JWT
import jwt, datetime
payload = {"sub": "user123", "exp": datetime.datetime.utcnow() + datetime.timedelta(minutes=30)}
token = jwt.encode(payload, SECRET_KEY, algorithm="HS256")

# –ü—Ä–æ–≤–µ—Ä–∫–∞
decoded = jwt.decode(token, SECRET_KEY, algorithms=["HS256"])
```

---

## 9. –¢–∏–ø–∏—á–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã

**Q:** –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω –∫–ª—é—á –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤?
**A:** –ù–µ—Ç. –î–µ–ª–µ–≥–∏—Ä—É–π—Ç–µ –ø—Ä–∞–≤–∞ ‚Äî –º–∏–Ω–∏–º—É–º –Ω—É–∂–Ω—ã–π –¥–ª—è –∫–∞–∂–¥–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (principle of least privilege).

**Q:** –ú–æ–∂–Ω–æ –ª–∏ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á–∏ –¥–ª—è –∞—É–¥–∏—Ç–∞?
**A:** –ù–µ—Ç, —Ç–æ–ª—å–∫–æ –∏—Ö —Ö—ç—à–∏ –∏–ª–∏ ID-–æ–±—ë—Ä—Ç–∫–∏.

**Q:** –ö–∞–∫ —á–∞—Å—Ç–æ –º–µ–Ω—è—Ç—å –∫–ª—é—á–∏?
**A:** –†–µ–≥—É–ª—è—Ä–Ω–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–∞–∂–¥—ã–µ 90 –¥–Ω–µ–π) –∏–ª–∏ –ø—Ä–∏ —É—Ç–µ—á–∫–µ.

**Q:** JWT –±–µ–∑–æ–ø–∞—Å–µ–Ω –±–µ–∑ HTTPS?
**A:** –ù–µ—Ç. –õ—é–±–æ–π —Ç–æ–∫–µ–Ω –±–µ–∑ TLS = —Ç–æ–∫–µ–Ω –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ.

---

## 10. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–Ω–∞–Ω–∏–π (–º–∏–Ω–∏-—Ç–µ—Å—Ç)

1. –ü–æ—á–µ–º—É –Ω–µ–ª—å–∑—è —Ö—Ä–∞–Ω–∏—Ç—å API-–∫–ª—é—á –≤ GitHub?
2. –ö–∞–∫ –æ—Ç–ª–∏—á–∏—Ç—å API-–∫–ª—é—á –æ—Ç —Ç–æ–∫–µ–Ω–∞ –ø–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏?
3. –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –ø–æ–ª–µ `exp` –≤ JWT –∏ –ø–æ—á–µ–º—É –æ–Ω–æ –∫—Ä–∏—Ç–∏—á–Ω–æ?
4. –ö–∞–∫ –∑–∞—â–∏—Ç–∏—Ç—å—Å—è –æ—Ç –∫—Ä–∞–∂–∏ —Ç–æ–∫–µ–Ω–∞ –ø—Ä–∏ XSS?
5. –ß–µ–º –æ–ø–∞—Å–µ–Ω `alg: none` –≤ JWT?
6. –ß—Ç–æ —Ç–∞–∫–æ–µ ¬´—Ä–æ—Ç–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤¬ª –∏ –∑–∞—á–µ–º –æ–Ω–∞ –Ω—É–∂–Ω–∞?

---

## 11. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ (–¥–ª—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π)

**–ó–∞–¥–∞—á–∞:**
–°–æ–∑–¥–∞—Ç—å –Ω–µ–±–æ–ª—å—à–æ–π CLI-—Å–µ—Ä–≤–∏—Å –Ω–∞ Python, –∫–æ—Ç–æ—Ä—ã–π:

* –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç API-–∫–ª—é—á–∏ (—Å UUID + salt);
* —Ö—Ä–∞–Ω–∏—Ç –∏—Ö —Ö—ç—à–∏ –≤ JSON-—Ñ–∞–π–ª–µ;
* –≤—ã–¥–∞—ë—Ç –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç JWT-—Ç–æ–∫–µ–Ω—ã (`HS256`);
* —É–º–µ–µ—Ç –æ—Ç–∑—ã–≤–∞—Ç—å –∫–ª—é—á–∏.

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏:**

* —Ç–æ–∫–µ–Ω—ã –∏–º–µ—é—Ç —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ–¥–ø–∏—Å–∏;
* API-–∫–ª—é—á–∏ –Ω–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ;
* —Å–µ–∫—Ä–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `.env` (–Ω–µ –≤ –∫–æ–¥–µ);
* —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ —Ä–æ—Ç–∞—Ü–∏–∏ –∫–ª—é—á–µ–π.

---

# üß© JWT (JSON Web Token)

## –ß—Ç–æ —ç—Ç–æ

**JWT (JSON Web Token)** ‚Äî —ç—Ç–æ –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ **–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** –º–µ–∂–¥—É —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ (–æ–±—ã—á–Ω–æ ‚Äî –º–µ–∂–¥—É —Å–µ—Ä–≤–µ—Ä–æ–º –∏ –∫–ª–∏–µ–Ω—Ç–æ–º).

JWT –Ω–µ —à–∏—Ñ—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é), –∞ –ª–∏—à—å **–ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç** –∏—Ö, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ:

1. —Ç–æ–∫–µ–Ω **–Ω–µ –ø–æ–¥–¥–µ–ª–∞–Ω**,
2. –∏ –æ–Ω –±—ã–ª —Å–æ–∑–¥–∞–Ω –≤–ª–∞–¥–µ–ª—å—Ü–µ–º –∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ **—Å–µ–∫—Ä–µ—Ç–∞** (–∫–ª—é—á–∞).

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞

JWT –≤—Å–µ–≥–¥–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ **—Ç—Ä—ë—Ö —á–∞—Å—Ç–µ–π**, —Ä–∞–∑–¥–µ–ª—ë–Ω–Ω—ã—Ö —Ç–æ—á–∫–∞–º–∏:

```
xxxxx.yyyyy.zzzzz
```

–≥–¥–µ:

| –ß–∞—Å—Ç—å | –ù–∞–∑–≤–∞–Ω–∏–µ      | –°–æ–¥–µ—Ä–∂–∏–º–æ–µ                                       |
| ----- | ------------- | ------------------------------------------------ |
| 1     | **Header**    | –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ —Ç–æ–∫–µ–Ω–µ ‚Äî —Ñ–æ—Ä–º–∞—Ç, –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ–¥–ø–∏—Å–∏   |
| 2     | **Payload**   | –ø–æ–ª–µ–∑–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (claims)                         |
| 3     | **Signature** | –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –ø–æ–¥–ø–∏—Å—å (–≥–∞—Ä–∞–Ω—Ç–∏—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏) |

–ü—Ä–∏–º–µ—Ä (—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π):

```json
Header:  {"alg": "HS256", "typ": "JWT"}
Payload: {"sub": "user123", "role": "admin", "exp": 1730816400}
Signature: HMAC_SHA256(secret, base64url(header) + "." + base64url(payload))
```

–í—Å—ë —ç—Ç–æ –∫–æ–¥–∏—Ä—É–µ—Ç—Å—è –≤ **Base64URL**, –ø–æ—ç—Ç–æ–º—É —Ç–æ–∫–µ–Ω –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ –¥–ª–∏–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞:

```
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.
eyJzdWIiOiJ1c2VyMTIzIiwicm9sZSI6ImFkbWluIiwiZXhwIjoxNzMwODE2NDAwfQ.
G_wQAljQXHfKqzRZ3HVefn4oI5-4fuxDGNG1gvlAy6A
```

---

## –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è (claims)

* `sub` ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å—É–±—ä–µ–∫—Ç–∞ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
* `iat` ‚Äî –≤—Ä–µ–º—è –≤—ã–ø—É—Å–∫–∞ (issued at)
* `exp` ‚Äî –≤—Ä–µ–º—è –∏—Å—Ç–µ—á–µ–Ω–∏—è (expiration)
* `nbf` ‚Äî not before (–Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–Ω—å—à–µ)
* `iss` ‚Äî –∏–∑–¥–∞—Ç–µ–ª—å (issuer)
* `aud` ‚Äî –∞—É–¥–∏—Ç–æ—Ä–∏—è (–∫–æ–º—É –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω —Ç–æ–∫–µ–Ω)
* `role`, `scope` ‚Äî –∫–∞—Å—Ç–æ–º–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ –ø—Ä–∞–≤–∞—Ö

---

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–°–µ—Ä–≤–µ—Ä —Å–æ–∑–¥–∞—ë—Ç —Ç–æ–∫–µ–Ω**

   * –§–æ—Ä–º–∏—Ä—É–µ—Ç `header` –∏ `payload`
   * –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç –∏—Ö —Å–µ–∫—Ä–µ—Ç–Ω—ã–º –∫–ª—é—á–æ–º ‚Üí —Å–æ–∑–¥–∞—ë—Ç `signature`
2. **–ö–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç —Ç–æ–∫–µ–Ω**

   * –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–≥–æ –≤ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ (–æ–±—ã—á–Ω–æ –≤ `Authorization: Bearer ...`)
3. **–°–µ—Ä–≤–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å**

   * –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –ø–æ–¥–ø–∏—Å—å —Å —Ç–µ–º –∂–µ —Å–µ–∫—Ä–µ—Ç–æ–º
   * –ï—Å–ª–∏ –ø–æ–¥–ø–∏—Å—å —Å–æ–≤–ø–∞–ª–∞ ‚Üí —Ç–æ–∫–µ–Ω –Ω–µ –ø–æ–¥–¥–µ–ª–∞–Ω

---

## –ü–æ—á–µ–º—É JWT –±–µ–∑–æ–ø–∞—Å–µ–Ω (–∏ –∫–æ–≥–¥–∞ –Ω–µ—Ç)

JWT **—Å–∞–º —Å–µ–±—è –Ω–µ—Å—ë—Ç** ‚Äî –≤ –Ω—ë–º –µ—Å—Ç—å –≤—Å–µ –Ω—É–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –∞ –ø–æ–¥–ø–∏—Å—å –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –æ–Ω–∏ –Ω–µ –∏–∑–º–µ–Ω—è–ª–∏—Å—å.
–ù–æ –µ—Å–ª–∏:

* –∫–ª—é—á –ø–æ–¥–ø–∏—Å–∏ —Å–ª–∞–±—ã–π (`secret123`),
* –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–ª–≥–æ—Ä–∏—Ç–º –±–µ–∑ –ø–æ–¥–ø–∏—Å–∏ (`alg: none`),
* –∏–ª–∏ —Ç–æ–∫–µ–Ω –∂–∏–≤—ë—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ (`exp` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç) ‚Äî

—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ä—É—à–∏—Ç—Å—è.

---

# üîê HMAC –∏ HMAC-–∫–ª—é—á

## –ß—Ç–æ —Ç–∞–∫–æ–µ HMAC

**HMAC (Hash-based Message Authentication Code)** ‚Äî —ç—Ç–æ —Å–ø–æ—Å–æ–± —Å–æ–∑–¥–∞—Ç—å **–ø–æ–¥–ø–∏—Å—å —Å–æ–æ–±—â–µ–Ω–∏—è** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **—Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞** –∏ **—Ö—ç—à-—Ñ—É–Ω–∫—Ü–∏–∏** (–Ω–∞–ø—Ä–∏–º–µ—Ä, SHA256).

–ò–¥–µ—è:

> –¥–∞–∂–µ –µ—Å–ª–∏ –∫—Ç–æ-—Ç–æ –≤–∏–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –ø–æ–¥–ø–∏—Å—å, –æ–Ω –Ω–µ –º–æ–∂–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—É—é –ø–æ–¥–ø–∏—Å—å –±–µ–∑ –∑–Ω–∞–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–∞.

–§–æ—Ä–º—É–ª–∞ (—É–ø—Ä–æ—â—ë–Ω–Ω–æ):

```
HMAC(secret, message) = hash( (secret ‚äï opad) + hash( (secret ‚äï ipad) + message ) )
```

(–≥–¥–µ `ipad` –∏ `opad` ‚Äî —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è —Å–º–µ—à–∏–≤–∞–Ω–∏—è –±–∞–π—Ç)

---

## –í JWT HMAC –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–∞–∫:

–ï—Å–ª–∏ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ —Å—Ç–æ–∏—Ç `"alg": "HS256"`, —Ç–æ –ø–æ–¥–ø–∏—Å—å —Ç–æ–∫–µ–Ω–∞ ‚Äî —ç—Ç–æ –∏–º–µ–Ω–Ω–æ **HMAC-SHA256**.

```python
import hmac, hashlib, base64, json

header = {"alg": "HS256", "typ": "JWT"}
payload = {"sub": "user123", "exp": 1730816400}
secret = b"supersecretkey"

header_b64 = base64.urlsafe_b64encode(json.dumps(header).encode()).rstrip(b"=")
payload_b64 = base64.urlsafe_b64encode(json.dumps(payload).encode()).rstrip(b"=")
signing_input = header_b64 + b"." + payload_b64

signature = hmac.new(secret, signing_input, hashlib.sha256).digest()
signature_b64 = base64.urlsafe_b64encode(signature).rstrip(b"=")
jwt = (header_b64 + b"." + payload_b64 + b"." + signature_b64).decode()
```

---

## –ü–æ—á–µ–º—É HMAC –≤–∞–∂–µ–Ω

–ë–µ–∑ HMAC –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–≥ –±—ã:

* –∏–∑–º–µ–Ω–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ payload (`role: admin`);
* –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å –ø–æ–¥–ø–∏—Å—å;
* –∏ —Å–µ—Ä–≤–µ—Ä –±—ã –Ω–µ –∑–∞–º–µ—Ç–∏–ª –∏–∑–º–µ–Ω–µ–Ω–∏–π.

HMAC –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ **—Ç–æ–ª—å–∫–æ —Å–µ—Ä–≤–µ—Ä, –∑–Ω–∞—é—â–∏–π —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á**, –º–æ–∂–µ—Ç –≤—ã–ø—É—Å—Ç–∏—Ç—å –∏ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω.

---

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ HMAC –≤ JWT

* **HS256 / HS384 / HS512** ‚Äî —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–∞—è –ø–æ–¥–ø–∏—Å—å (HMAC + SHA)
* **RS256 / RS512** ‚Äî –∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–∞—è –ø–æ–¥–ø–∏—Å—å (RSA)
* **ES256** ‚Äî –∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–∞—è (ECDSA)

–†–∞–∑–Ω–∏—Ü–∞:

* HMAC (HS256) ‚Äî **–æ–¥–∏–Ω –æ–±—â–∏–π —Å–µ–∫—Ä–µ—Ç** –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏;
* RSA / ECDSA ‚Äî **—Ä–∞–∑–Ω—ã–µ –∫–ª—é—á–∏** (–ø—Ä–∏–≤–∞—Ç–Ω—ã–π –¥–ª—è –ø–æ–¥–ø–∏—Å–∏, –ø—É–±–ª–∏—á–Ω—ã–π –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏).

---

# ‚öôÔ∏è –†–µ–∑—é–º–µ

| –¢–µ—Ä–º–∏–Ω        | –ß—Ç–æ —ç—Ç–æ                                    | –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç                                      |
| ------------- | ------------------------------------------ | ------------------------------------------------- |
| **JWT**       | –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –¥–∞–Ω–Ω—ã–º–∏ + –ø–æ–¥–ø–∏—Å—å              | –ü–µ—Ä–µ–¥–∞—ë—Ç claims + –≥–∞—Ä–∞–Ω—Ç–∏—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏            |
| **HMAC**      | –ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ–¥–ø–∏—Å–∏                           | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ–∫—Ä–µ—Ç –∏ —Ö—ç—à –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏        |
| **HMAC-–∫–ª—é—á** | –°–µ–∫—Ä–µ—Ç–Ω–∞—è —Å—Ç—Ä–æ–∫–∞, –∏–∑–≤–µ—Å—Ç–Ω–∞—è —Ç–æ–ª—å–∫–æ —Å–µ—Ä–≤–µ—Ä—É | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ JWT (–≤ HS256) |

---

# üß† –ö–æ—Ä–æ—Ç–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã

‚úÖ **–°–æ–∑–¥–∞–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ JWT —Å HMAC**

```python
import jwt, datetime

SECRET_KEY = "supersecretkey"

token = jwt.encode(
    {"sub": "user123", "exp": datetime.datetime.utcnow() + datetime.timedelta(minutes=10)},
    SECRET_KEY,
    algorithm="HS256"
)
print(token)

# –ü—Ä–æ–≤–µ—Ä–∫–∞
decoded = jwt.decode(token, SECRET_KEY, algorithms=["HS256"])
print(decoded)
```

üö´ **–û–ø–∞—Å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç**

```json
{
  "alg": "none",
  "typ": "JWT"
}
```

# üß© –ß—Ç–æ —Ç–∞–∫–æ–µ —Ç–æ–∫–µ–Ω –ø–æ —Å—É—Ç–∏

–¢–æ–∫–µ–Ω ‚Äî —ç—Ç–æ **–∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ –∑–∞—â–∏—â—ë–Ω–Ω–∞—è –º–µ—Ç–∫–∞ –¥–æ–≤–µ—Ä–∏—è**.
–û–Ω–∞ **–Ω–µ —Ö—Ä–∞–Ω–∏—Ç –ø–∞—Ä–æ–ª—å**, –∞ –ª–∏—à—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ –∫–æ–≥–¥–∞-—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ **—É—Å–ø–µ—à–Ω–æ –∑–∞–ª–æ–≥–∏–Ω–∏–ª—Å—è**.

–¢–æ –µ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä –≥–æ–≤–æ—Ä–∏—Ç:

> ‚Äú–í–æ—Ç —Ç–µ–±–µ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ (—Ç–æ–∫–µ–Ω), —á—Ç–æ —è —Ç–µ–±—è –∑–Ω–∞—é. –ü–æ–∫–∞–∑—ã–≤–∞–π –µ–≥–æ –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö ‚Äî —è –ø—Ä–æ–≤–µ—Ä—é –ø–æ–¥–ø–∏—Å—å –∏ –≤–ø—É—â—É‚Äù.

---

# ‚öôÔ∏è –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è: –∫–ª–∏–µ–Ω—Ç ‚Üî —Å–µ—Ä–≤–µ—Ä

## 1. –ö–ª–∏–µ–Ω—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å.

```
POST /login
{
  "username": "alice",
  "password": "password123"
}
```

–°–µ—Ä–≤–µ—Ä:

1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–∞—Ä–æ–ª—å –ø–æ –ë–î (bcrypt/argon2 –∏ —Ç. –¥.);
2. –ï—Å–ª–∏ –≤—Å—ë –≤–µ—Ä–Ω–æ ‚Äî —Å–æ–∑–¥–∞—ë—Ç **—Ç–æ–∫–µ–Ω** (–Ω–∞–ø—Ä–∏–º–µ—Ä, JWT);
3. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –µ–≥–æ –∫–ª–∏–µ–Ω—Ç—É.

–û—Ç–≤–µ—Ç:

```json
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

---

## 2. –ö–ª–∏–µ–Ω—Ç —Ö—Ä–∞–Ω–∏—Ç —Ç–æ–∫–µ–Ω

–¢–µ–ø–µ—Ä—å –∫–ª–∏–µ–Ω—Ç —Ö—Ä–∞–Ω–∏—Ç —Ç–æ–∫–µ–Ω **–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ**:

* Web: httpOnly cookie –∏–ª–∏ sessionStorage (–Ω–µ localStorage!)
* Mobile: Secure Enclave / Keystore
* CLI: –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –∏–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è

–ü–∞—Ä–æ–ª—å –º–æ–∂–Ω–æ –≤—ã–±—Ä–æ—Å–∏—Ç—å ‚Äî –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –æ–Ω –Ω–µ –Ω—É–∂–µ–Ω.

---

## 3. –ö–ª–∏–µ–Ω—Ç –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å —Å —Ç–æ–∫–µ–Ω–æ–º

–ü—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ –∫–ª–∏–µ–Ω—Ç –ø—Ä–∏–∫–ª–∞–¥—ã–≤–∞–µ—Ç —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ:

```
GET /api/profile
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

---

## 4. –°–µ—Ä–≤–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–æ–∫–µ–Ω (–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞)

–ö–æ–≥–¥–∞ —Å–µ—Ä–≤–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç —Ç–æ–∫–µ–Ω, –æ–Ω:

1. **–ü–∞—Ä—Å–∏—Ç** –µ–≥–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, JWT ‚Üí header/payload/signature)
2. **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å**

   * –¥–ª—è JWT —Å `HS256` ‚Äî HMAC(—Å–µ–∫—Ä–µ—Ç, header+payload)
   * –¥–ª—è `RS256` ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å –æ—Ç–∫—Ä—ã—Ç—ã–º –∫–ª—é—á–æ–º
     –ï—Å–ª–∏ –ø–æ–¥–ø–∏—Å—å –Ω–µ —Å–æ–≤–ø–∞–ª–∞ ‚Äî —Ç–æ–∫–µ–Ω –ø–æ–¥–¥–µ–ª–∞–Ω ‚Üí –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è
3. **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è** (`exp`, `iat`)
4. **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∞—É–¥–∏—Ç–æ—Ä–∏—é / –∏–∑–¥–∞—Ç–µ–ª—è** (`aud`, `iss`)
5. –ï—Å–ª–∏ –≤—Å—ë –û–ö ‚Äî —Å—á–∏—Ç–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º.

–¢–µ–ø–µ—Ä—å —Å–µ—Ä–≤–µ—Ä *–Ω–µ —Ö—Ä–∞–Ω–∏—Ç —Å–µ—Å—Å–∏—é* ‚Äî —Ç–æ–∫–µ–Ω **—Å–∞–º –Ω–µ—Å—ë—Ç** –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.

---

## 5. –î–æ—Å—Ç—É–ø –∫ –∑–∞—â–∏—â—ë–Ω–Ω—ã–º —Ä–µ—Å—É—Ä—Å–∞–º

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏ —Å–µ—Ä–≤–µ—Ä –∏–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–æ–∫–µ–Ω–∞:

```json
{
  "sub": "user_42",
  "role": "admin",
  "exp": 1730816400
}
```

–∏ –Ω–∞ –∏—Ö –æ—Å–Ω–æ–≤–µ —Ä–µ—à–∞–µ—Ç, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `"user_42"` –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ `"admin"`.

---

## 6. –ò—Å—Ç–µ—á–µ–Ω–∏–µ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è —Ç–æ–∫–µ–Ω–∞

–ö–∞–∂–¥—ã–π —Ç–æ–∫–µ–Ω –∏–º–µ–µ—Ç —Å—Ä–æ–∫ (`exp`).
–ö–æ–≥–¥–∞ –≤—Ä–µ–º—è –∏—Å—Ç–µ–∫–∞–µ—Ç, —Å–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ—Å—Ç–∞—ë—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å —ç—Ç–æ—Ç —Ç–æ–∫–µ–Ω.

–ö–ª–∏–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –ª–∏–±–æ:

* –∑–∞–ª–æ–≥–∏–Ω–∏—Ç—å—Å—è —Å–Ω–æ–≤–∞, –ª–∏–±–æ
* –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **refresh token** (—Å–º. –Ω–∏–∂–µ).

---

# üß† –ü—Ä–∏–º–µ—Ä –Ω–∞ JWT (HS256)

1Ô∏è‚É£ **–í—ã–¥–∞—á–∞ —Ç–æ–∫–µ–Ω–∞**

```python
import jwt, datetime

SECRET_KEY = "supersecret"

def issue_token(user_id):
    payload = {
        "sub": user_id,
        "iat": datetime.datetime.utcnow(),
        "exp": datetime.datetime.utcnow() + datetime.timedelta(minutes=15)
    }
    return jwt.encode(payload, SECRET_KEY, algorithm="HS256")
```

‚Üí —Å–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä–æ–∫—É `eyJhbGciOiJIUzI1Ni...`

---

2Ô∏è‚É£ **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞**

```python
def verify_token(token):
    try:
        payload = jwt.decode(token, SECRET_KEY, algorithms=["HS256"])
        return payload   # –ø–æ–¥–ø–∏—Å—å –≤–∞–ª–∏–¥–Ω–∞, —Ç–æ–∫–µ–Ω –Ω–µ –∏—Å—Ç—ë–∫
    except jwt.ExpiredSignatureError:
        return None      # —Ç–æ–∫–µ–Ω –ø—Ä–æ—Å—Ä–æ—á–µ–Ω
    except jwt.InvalidTokenError:
        return None      # –ø–æ–¥–¥–µ–ª–∞–Ω / –Ω–µ–≤–µ—Ä–Ω—ã–π
```

---

# üîê –ü–æ—á–µ–º—É —ç—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ

| –ú–µ—Ö–∞–Ω–∏–∑–º                   | –ó–∞—â–∏—Ç–∞ –æ—Ç —á–µ–≥–æ                                    |
| -------------------------- | ------------------------------------------------- |
| **–ü–æ–¥–ø–∏—Å—å (HMAC –∏–ª–∏ RSA)** | –ü–æ–¥–¥–µ–ª–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–æ–∫–µ–Ω–µ                          |
| **–ü–æ–ª–µ `exp`**             | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤                      |
| **HTTPS**                  | –ü—Ä–æ—Å–ª—É—à–∫–∞ —Ç–æ–∫–µ–Ω–∞ –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ                     |
| **httpOnly Cookie**        | –ö—Ä–∞–∂–∞ —Ç–æ–∫–µ–Ω–∞ —á–µ—Ä–µ–∑ XSS                            |
| **Refresh tokens**         | –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —Å–µ—Å—Å–∏–∏ –±–µ–∑ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ access-—Ç–æ–∫–µ–Ω–∞ |
| **–†–æ—Ç–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤**        | –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö refresh-—Ç–æ–∫–µ–Ω–æ–≤    |

---

# üîÑ Access –∏ Refresh —Ç–æ–∫–µ–Ω—ã

–ß—Ç–æ–±—ã –Ω–µ –¥–µ—Ä–∂–∞—Ç—å access-—Ç–æ–∫–µ–Ω —Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–æ, –≤–≤–æ–¥—è—Ç **–¥–≤–∞ —Ç–æ–∫–µ–Ω–∞**:

| –¢–∏–ø               | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                     | –°—Ä–æ–∫ –∂–∏–∑–Ω–∏           |
| ----------------- | ------------------------------ | -------------------- |
| **Access Token**  | –ù–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ API  | –ö–æ—Ä–æ—Ç–∫–∏–π (15‚Äì30 –º–∏–Ω) |
| **Refresh Token** | –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ access-—Ç–æ–∫–µ–Ω–∞ | –î–ª–∏–Ω–Ω—ã–π (7‚Äì30 –¥–Ω–µ–π)  |

–ú–µ—Ö–∞–Ω–∏–∑–º:

1. –ö–ª–∏–µ–Ω—Ç –ª–æ–≥–∏–Ω–∏—Ç—Å—è ‚Üí –ø–æ–ª—É—á–∞–µ—Ç –æ–±–∞ —Ç–æ–∫–µ–Ω–∞.
2. –ö–æ–≥–¥–∞ access –∏—Å—Ç—ë–∫ ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç refresh –Ω–∞ `/refresh`.
3. –°–µ—Ä–≤–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç refresh, —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π access.
4. Refresh —Ç–æ–∫–µ–Ω –ø—Ä–∏ —ç—Ç–æ–º **—Ä–æ—Ç—É–∏—Ä—É–µ—Ç—Å—è** (—Å—Ç–∞—Ä—ã–π –æ—Ç–∑—ã–≤–∞–µ—Ç—Å—è, –Ω–æ–≤—ã–π –≤—ã–¥–∞–µ—Ç—Å—è).

---

# üö® –ß—Ç–æ –º–æ–∂–µ—Ç –ø–æ–π—Ç–∏ –Ω–µ —Ç–∞–∫

| –û—à–∏–±–∫–∞                        | –ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏–µ                           |
| ----------------------------- | ------------------------------------- |
| `alg: none`                   | —Ç–æ–∫–µ–Ω –º–æ–∂–Ω–æ –ø–æ–¥–¥–µ–ª–∞—Ç—å –≤—Ä—É—á–Ω—É—é         |
| —Å–ª–∞–±—ã–π —Å–µ–∫—Ä–µ—Ç                 | –º–æ–∂–Ω–æ –ø–æ–¥–æ–±—Ä–∞—Ç—å –ø–æ–¥–ø–∏—Å—å (brute force) |
| —Ç–æ–∫–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ localStorage | XSS = –∫—Ä–∞–∂–∞ —Ç–æ–∫–µ–Ω–∞                    |
| –Ω–µ—Ç `exp`                     | —Ç–æ–∫–µ–Ω –±–µ—Å—Å—Ä–æ—á–Ω—ã–π                      |
| –ø–µ—Ä–µ–¥–∞—á–∞ –ø–æ HTTP              | —Ç–æ–∫–µ–Ω —É—Ç–µ–∫–∞–µ—Ç –≤ —Å–µ—Ç—å                  |
| –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏   | –ª—é–±–∞—è —Å—Ç—Ä–æ–∫–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è –∫–∞–∫ —Ç–æ–∫–µ–Ω    |

---

# üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: —Ç–æ–∫–µ–Ω vs —Å–µ—Å—Å–∏—è

| –ö—Ä–∏—Ç–µ—Ä–∏–π                     | –°–µ—Å—Å–∏–æ–Ω–Ω—ã–µ cookies      | JWT —Ç–æ–∫–µ–Ω                       |
| ---------------------------- | ----------------------- | ------------------------------- |
| –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è           | –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ              | –í —Ç–æ–∫–µ–Ω–µ                        |
| –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å             | –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞              | –≤—ã—Å–æ–∫–∞—è                         |
| –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö          | –≤—ã—Å–æ–∫–∞—è (—Å–µ—Ä–≤–µ—Ä —Ö—Ä–∞–Ω–∏—Ç) | –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏ –ø–æ–¥–ø–∏—Å–∏ |
| –ü—Ä–æ—Å—Ç–æ—Ç–∞ –æ—Ç–∑—ã–≤–∞              | –ª–µ–≥–∫–æ                   | —Å–ª–æ–∂–Ω–µ–µ (blacklist)             |
| –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ | –Ω–µ –≤—Å–µ–≥–¥–∞ —É–¥–æ–±–Ω–æ        | –ª–µ–≥–∫–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —á–µ—Ä–µ–∑ API      |

---

# üí¨ –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ

‚úÖ **–¢–æ–∫–µ–Ω** ‚Äî –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–µ —Å–µ–∫—Ä–µ—Ç–æ–º.
‚úÖ **HMAC-–ø–æ–¥–ø–∏—Å—å** –∑–∞—â–∏—â–∞–µ—Ç —Ç–æ–∫–µ–Ω –æ—Ç –ø–æ–¥–¥–µ–ª–∫–∏.
‚úÖ **–°–µ—Ä–≤–µ—Ä –Ω–µ —Ö—Ä–∞–Ω–∏—Ç —Å–µ—Å—Å–∏–∏** ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å –∏ `exp`.
‚úÖ **–ë–µ–∑ HTTPS –∏ —Å—Ä–æ–∫–æ–≤ –¥–µ–π—Å—Ç–≤–∏—è —Ç–æ–∫–µ–Ω –Ω–µ–±–µ–∑–æ–ø–∞—Å–µ–Ω**.
‚úÖ **Refresh —Ç–æ–∫–µ–Ω—ã** –ø–æ–∑–≤–æ–ª—è—é—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –¥–æ–ª–≥–∏–µ —Å–µ—Å—Å–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ.

---
